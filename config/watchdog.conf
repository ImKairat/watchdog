-- Global settings
global = {
    log_file = "/var/log/watchdog/watchdog.log",
    log_level = "info",
    max_workers = 4
}

-- Define reusable patterns
patterns = {
    source_files = {"*.zig", "*.c", "*.h", "*.cpp"},
    config_files = {"*.conf", "*.json", "*.yaml"},
    build_files = {"Makefile", "build.zig", "CMakeLists.txt"}
}

-- valid_events = {"create", "modify", "delete", "rename", "attrib"}

-- Watchers configuration
watchers = {
    -- Group Watchers:
    {
        name = "backend_source",
        path = "/home/user/project/src",
        recursive = true,
        patterns = patterns.source_files,
        events = {"modify", "create"},
        debounce = 500,
        min_size = 512M,
        actions = {
            {type = "log", level = "info", message = "Source file changed: ${file}"},
            {
                type = "command",
                cmd = "zig build",
                timeout = 30,
                cwd = "/home/user/project",
                retry = 2,
                background = false
            },
            {type = "command", cmd = "notify-send 'Build triggered'", ignore_errors = true, background = true}
        },
        schedule = {
            days = {"Mon", "Tue", "Wed", "Thu", "Fri"},
            time_range = {start = "09:00", end = "18:00"}
        }
    },
    
    {
        name = "config_watcher",
        path = "/etc/myapp/config.conf",
        events = {"modify"},
        debounce = 1000, -- milliseconds
        actions = {
            {type = "log", level = "warn"},
            {type = "command", cmd = "systemctl reload myapp"}
        }
    }
}